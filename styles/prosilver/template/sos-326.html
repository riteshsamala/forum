<!-- INCLUDE overall_header.html -->

<h2>SOS 326:  Sustainable Ecosystems</h2>

<div class="panel">
   <div class="inner"><span class="corners-top"><span></span></span>

   <div class="content">
      <p>

    <script type="text/javascript">
        dojoConfig = {isDebug: true, parseOnLoad: true};
    </script>
   <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/dojo/1.9.1/dojo/dojo.js"></script>

    <link href='//ajax.googleapis.com/ajax/libs/dojo/1.9.1/dijit/themes/claro/claro.css' rel='stylesheet' type='text/css' />


    <style type="text/css">
        body {
            background-color: #C6F5F2;
            font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;
        }

        #content {
            background-color:#C6F5F2;
            // width:950px;
            // min-height:450px;
            text-align:left;
            padding:20px;
        }

        h2 {
            // padding-left: 0px !important;
            // text-align:right;
        }

        .large { font-size:22px; }
        .orange { color:orange; }
        .italic { font-style:italic }
        .textmiddle {vertical-align:middle;}
        .padout { padding-left:25px; padding-right:25px; }

        .rounded-corners {
            -moz-border-radius: 40px;
            -webkit-border-radius: 40px;
            -khtml-border-radius: 40px;
            border-radius: 40px;
        }
        .rounded-corners-top {
            -moz-border-top-radius: 40px;
            -webkit-border-radius: 40px;
            -khtml-border-radius: 40px;
            border-radius: 40px;
        }
        .right {
            float: right;
        }
        .scrolldown {
            padding-left:20px;
            color:#EDECE8; font-size:40px;
            font-weight:bold;
            vertical-align:middle;
            text-shadow: #6374AB 2px 2px 2px;
        }
        .contentblock { margin: 0px 20px; }
        .results { border: 1px solid blue; padding:20px; margin-top:20px; min-height:50px; }
        .blue-bold { font-size:18px; font-weight:bold; color:blue; }

        .problem-selection-form {
            background: url("/devel/form-fieldset.gif") repeat-x scroll left bottom #F8FDEF;
            border: 1px solid #DFDCDC;
            border-radius: 15px 15px 15px 15px;
            display: inline-block;
            margin-bottom: 30px;
            margin-left: 20px;
            margin-top: 10px;
            padding: 25px 50px 10px;
            width: 390px;
        }

        .problem-selection-form .fieldgroup {
            background: url("/devel/form-divider.gif") repeat-x scroll left top transparent;
            display: inline-block;
            padding: 8px 10px;
            width: 380px;
        }

        .problem-selection-form .fieldgroup label {
            float: left;
            padding: 15px 5px 0;
            text-align: right;
            width: 120px;
            font-weight:bold;
        }

        .problem-selection-form .fieldgroup input, #problem-selection-form .fieldgroup textarea, #problem-selection-form .fieldgroup select {
            float: right;
            margin: 10px 0;
            height: 30px;
        }

        .problem-selection-form .submit {
            padding: 10px;
            width: 220px;
            height: 40px !important;
        }

        .problem-selection-form .fieldgroup label.error {
            color: #FB3A3A;
            display: inline-block;
            margin: 4px 0 5px 175px;
            padding: 0;
            text-align: left;
            width: 220px;
        }
    </style>

    <script type="text/javascript">

 
var pid=[];  // global list of the problem ids

require(["dojo/parser","dojo/dom","dijit/registry","dijit/form/Select", 
         "dojo/request/xhr","dojo/_base/array",
         "dojo/dom-construct", 
         "dojo/json","dojo/domReady!"],
function(parser,dom,registry,Select,xhr,array,domConst,JSON){
    parser.parse();  // Make sure widgets are defined

function addProblems(){
    xhr("/devel/available_problems.php",{
      // Script also wants "student" but we will assume
      // All solutions are shared in this class
      query: {
        // This should be gotten from the appropriate section
        // form field (or java should set that field).
        section: "sos-326"
      },
      handleAs: "json"
    }).then(function(data){
        var widget = registry.byId("custom_problems");
        console.log("retrieved problems:  ",data);
        widget.options=[];  // clear any existing options.
        widget.addOption({label:"--choose problem--",value:""});
        pid=[];
        var i=1;  // value=0 acts like value=''
        array.forEach(data,function(datum){
           pid[i]=datum;  // record value for submit handling
           var y={label:datum.problemname+" by "+datum.author,
                             value:i++};
           widget.addOption(y);
        });
    },
    function(err){
       console.log("an error occurred:  ",err);
    });
  };

  // initially populate options on startup
  addProblems();

  // Update options list which select is selected.
  var widget=registry.byId("custom_problems");
  console.log("add connect to ",widget);
  dojo.connect(widget,"onClick",addProblems);
});


        function setMode(theForm){
	  var prob=theForm.problem_id.value;
	  if(prob=="ecosystem" || prob=="predator-prey"){
	    theForm.mode.value="AUTHOR";
	  } else if(prob=="74" || prob=="110"){
	    theForm.mode.value="COACHED";
	  } else {
	    console.warn("Invalid problem",theForm.problem_id.value);
	  }
          console.log("Mode for '",theForm.problem_id.value,"' is ",theForm.mode.value);
	  return true;
        }

function addAuthor(formName){
    var form=document.forms[formName];
     var id=form["problem_id"].value;
    var datum=pid[id];
    form["problem_id"].value=datum.problemname;
    form["author"].value=datum.author;
}

    </script>

<div id="page-wrap">

    <div id="content">

  <form action="/devel/startup.php"  onsubmit="return setMode(this);" method="POST"
        name="iniProbs" class="problem-selection-form">
       <h2>Initial Problems</h2>

    <input type="hidden" name="mode" value="STUDENT">
    <input type="hidden" name="section" value="sos-326">
    <input type="hidden" name="username" value="{S_USERNAME}">
    <input type="hidden" name="forumurl" 
           value="{BOARD_URL}viewtopic.php">

                   <div class="fieldgroup">
                        <label for="initial_problems">Problem Name: </label>
                        <select id="initial_problems" name="problem_id">
                          <option value="74">Dying orchard</option>
                          <option value="110">Chestnut blight</option>
			  <!-- <option value="ecosystem">Ecosystem</option> -->
			  <option value="predator-prey">Predator-prey</option>
                        </select>
                    </div>

                    <div class="fieldgroup">
                        <button type="submit" value="Continue" class="submit">
                        Open problem
                        </button>
                    </div>
     </form>


  <form action="/devel/startup.php" method="POST" class="problem-selection-form">
          <h2>Coached problems</h2>

        You can use the <a href="/intro-handout.pdf">handout</a> to help you.<br>

        	   <input type="hidden" name="username" value="{S_USERNAME}">
              <input type="hidden" name="mode" value="COACHED">
              <input type="hidden" name="section" value="sos-326">
    	      <input type="hidden" name="forumurl" 
		     value="{BOARD_URL}viewtopic.php">
                    <div class="fieldgroup">
                        <label for="coached_problems">Problem: </label>
                        <select id="coached_problems" name="problem_id">
                           <!-- These should be filled dynamially from map, Bug #2183 --> 
                            <option value="jared1">Jared's weight</option>
                            <option value="jared2">Jared &amp; Oprah</option>
                            <option value="jared3">Jared &amp; Oprah +</option>
                            <option value="jared4">Jared &amp; Oprah *</option>
                            <option value="dodos">Dodo extinction</option>
                            <option value="rabbits">Rabbit population</option>
                         </select>
                    </div>

                    <div class="fieldgroup">
                        <button type="submit" value="Continue" class="submit">
                        Open problem
                        </button>
                    </div>
  </form>                   


        <form action="/devel/startup.php" method="POST" class="problem-selection-form">

            <h2>Additional Dragoon Problems</h2>
        	   <input type="hidden" name="username" value="{S_USERNAME}">
                   <input type="hidden" name="mode" value="STUDENT">
		   <input type="hidden" name="forumurl"
			  value="{BOARD_URL}viewtopic.php">

                    <div class="fieldgroup">
                        <label for="problem_category">Problem Category: </label>
                        <select id="problem_category" name="problem_category">
                           <!-- These should be filled dynamically from map, Bug #2183 --> 
                           <option>Isle Royale</option>
                          <!--  <option>Urban Waterfowl</option>  -->
                           <option>Kinematics</option> 
                           <option>Easy</option>
                           <option>Training</option>
                           <option>Challenge</option>
			    
                        </select>
                    </div>

                    <div class="fieldgroup">
                        <label for="additional_problems">Problem: </label>
                        <select id="additional_problems" name="problem_id">
                           <!-- These should be filled dynamially from map, Bug #2183 --> 
                            <option value="isle1">Moose population 1</option>
                            <option value="isle2">Moose population 2</option>
                            <option value="isle3">Moose population 3</option>
                            <option value="isle4">Moose population 4</option>
                            <option value="isle5">Wolves</option>
                            <option value="isle6">Moose and Wolves</option>                            
                        </select>
                    </div>

                    <input type="hidden" name="section" value="sos-326">

                    <div class="fieldgroup">
                        <button type="submit" value="Continue" class="submit">
                        Open problem
                        </button>
                    </div>


        </form>

        <form action="/devel/startup.php" method="POST" class="problem-selection-form">

            <h2>Author a custom problem</h2>


		    <input type="hidden" name="username" value="{S_USERNAME}">
		    <input type="hidden" name="mode" value="author">
		    <input type="hidden" name="forumurl" 
			  value="{BOARD_URL}viewtopic.php">

                    <div class="fieldgroup">
                        <label for="author_problem">Problem: </label>
                        <input type="text" id="author_problem" 
                            name="problem_id" onChange="javascript:this.value=this.value.toLowerCase();">
                    </div>

                    <input type="hidden" name="section" value="sos-326">

                    <div class="fieldgroup">
                        <button type="submit" value="Continue" class="submit">
                        Open problem
                        </button>
                    </div>


        </form>

        <form action="/devel/startup.php" method="POST" 
	      name="custom_student"
              onsubmit="return addAuthor('custom_student');" 
	      class="problem-selection-form">

            <h2>Solve a custom problem</h2>
		    <input type="hidden" name="username" value="{S_USERNAME}">
		    <input type="hidden" name="forumurl" 
			   value="{BOARD_URL}viewtopic.php">
		    <input type="hidden" name="mode" value="student">
                    <input type="hidden" name="section" value="sos-326">
                    <!-- value will be overwritten by function addAuthor -->
                    <input type="hidden" name="author" value="">


           <div class="claro">
    <!-- Needs to be a dijit for addOption to work -->
    <select id="custom_problems" name="problem_id"
      data-dojo-type="dijit/form/Select">
      <!-- This gets overwritten by the javascript -->
      <option value="">--choose--</option>
    </select>
           </div>

                    <div class="fieldgroup">
                        <button type="submit" value="Continue" class="submit">
                        Open problem
                        </button>
                    </div>


        </form>

   <h2><a href="viewforum.php?f=4">Problem Discussions</a></h2>


    </div>

</div>

</p>
</div>

<!-- INCLUDE jumpbox.html -->
<!-- INCLUDE overall_footer.html -->
